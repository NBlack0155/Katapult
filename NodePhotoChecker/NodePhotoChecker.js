javascript:(()=>{let paused=false,stopped=false,waitingForClick=true,lastHighlight=null,controlContainer=document.createElement('div');Object.assign(controlContainer.style,{position:'fixed',top:'10px',left:'10px',zIndex:99999,background:'rgba(0,0,0,0.7)',padding:'8px',borderRadius:'8px',display:'flex',gap:'4px'});const createButton=(text,handler,bg='green')=>{const btn=document.createElement('button');btn.textContent=text;Object.assign(btn.style,{padding:'4px 8px',fontSize:'12px',cursor:'pointer',background:bg,color:'#fff'});btn.addEventListener('click',handler);controlContainer.appendChild(btn);return btn;};const pauseBtn=createButton('Pause/Resume',()=>{},'green'),stopBtn=createButton('Stop',()=>{stopped=true;controlContainer.remove();console.log('Script stopped');});document.body.appendChild(controlContainer);document.addEventListener('keydown',e=>{if(e.ctrlKey&&!e.repeat){paused=!paused;pauseBtn.style.background=paused?'orange':'green';console.log(paused?'Script paused':'Script resumed');}});function findAllPhotoViewers(root,results=[]){if(!root)return results;function recurse(node){if(node.tagName==='KATAPULT-PHOTO-VIEWER')results.push(node);if(node.shadowRoot)recurse(node.shadowRoot);if(node.children)Array.from(node.children).forEach(recurse);}recurse(root);return results;}function highlightElement(el){const rect=el.getBoundingClientRect();const box=document.createElement('div');Object.assign(box.style,{position:'absolute',top:rect.top+'px',left:rect.left+'px',width:rect.width+'px',height:rect.height+'px',border:'3px solid red',background:'rgba(255,0,0,0.2)',zIndex:9999,pointerEvents:'none'});document.body.appendChild(box);return box;}function clickPhotoViewer(photo){photo.dispatchEvent(new MouseEvent('mouseover',{bubbles:true}));photo.dispatchEvent(new MouseEvent('mousedown',{bubbles:true}));photo.dispatchEvent(new MouseEvent('mouseup',{bubbles:true}));photo.dispatchEvent(new MouseEvent('click',{bubbles:true}));}document.addEventListener('click',async function handler(e){if(stopped)return document.removeEventListener('click',handler);if(paused)return;if(!waitingForClick)return;waitingForClick=false;if(lastHighlight){lastHighlight.remove();lastHighlight=null;}await new Promise(r=>setTimeout(r,150));const root=document.querySelector('#pageElement')?.shadowRoot||document.body;const viewers=findAllPhotoViewers(root);if(!viewers.length){console.log('No katapult-photo-viewer found');waitingForClick=true;return;}const photo=viewers[viewers.length-1];lastHighlight=highlightElement(photo);await new Promise(r=>setTimeout(r,100));clickPhotoViewer(photo);lastHighlight.remove();lastHighlight=null;console.log('Photo clicked by script');waitingForClick=true;})();})();
